function myMap(){var e=getAllUrlParams().county
try{readTextFile("data/job_data.json",function(t){var a=JSON.parse(t),r=initMap(a,e)
markerpPlacement(a,r,e),setMapOnAll(r)
new Vue({el:"#floating-panel",methods:{changeCenter:function(){e=getAllUrlParams().county
var t=markers
setMapOnAll(null),markers=[]
var r=initMap(a,e)
if(markers=t,setMapOnAll(r),"DUBLIN"==e.toUpperCase()){var s={imagePath:"images/m"}
markerCluster=new MarkerClusterer(r,markers,s)}}}}),new Vue({el:"#floating-panel2",methods:{changeCenter:function(){var e=getAllUrlParams().county
setMapOnAll(null),markers=[]
var t=initMap(a,e)
markerpPlacement(a,t,e),setMapOnAll(t)}}})})}catch(t){console.log(t.message)}}function calculateDistance(e,t,a,r){var s=function(e){return e*Math.PI/180},n=6378137,o=s(a-e),i=s(r-t),l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(s(e)*Math.cos(s(a)))*Math.sin(i/2)*Math.sin(i/2),p=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),g=n*p
return g/1e3}function initMap(e,t){var a=e[t].longitude,r=e[t].latitude,s=e[t].zoom,n=[{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#e0efef"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"},{hue:"#1900ff"},{color:"#c0e8e8"}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"on"},{lightness:700}]},{featureType:"water",elementType:"all",stylers:[{color:"#7dcdcd"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],o={center:new google.maps.LatLng(r,a),zoom:s,styles:n},i=new google.maps.Map(document.getElementById("googleMap"),o)
return i}function addMarker(e,t,a,r,s,n){var o=new google.maps.Marker({position:new google.maps.LatLng(e.ID[a].lat,e.ID[a].lng),info:new google.maps.InfoWindow({content:r}),icon:{url:s,scaledSize:new google.maps.Size(32,32)},animation:google.maps.Animation.DROP,url:n,map:t})
return google.maps.event.addListener(o,"mouseover",function(){this.info.open(t,this)}),google.maps.event.addListener(o,"mouseout",function(){this.info.close()}),o}function setMapOnAll(e){for(var t=0;t<markers.length;t++)markers[t].setMap(e)}function markerpPlacement(e,t,a){for(var r=Object.keys(e.ID).length,s=getAllUrlParams().industry,n=0;r>n;n++){var o=e.ID[n].county,i=e.ID[n].industry
try{if(void 0!==o&&s==i&&(o.toUpperCase()==a.toUpperCase()||o.toUpperCase().includes(a.toUpperCase()))){var l=e.ID[n].joburl,p=e.ID[n].salary,g=e.ID[n].homepage
if(null!==g)var c="<div style='float:left'><img src='http://i.stack.imgur.com/g672i.png'></div><div style = 'float:right; padding:10px; font-size:18px'><strong>"+e.ID[n].title+"</strong><br><br><strong>COMPANY: </strong>"+e.ID[n].company.toUpperCase()+"<br><strong>SALARY: </strong>"+p+"<br><strong>HOMEPAGE: </strong>"+g+"</div>"
else var c="<div style='float:left'><img src='http://i.stack.imgur.com/g672i.png'></div><div style = 'float:right; padding:10px; font-size:18px'><strong>"+e.ID[n].title+"</strong><br><br><strong>COMPANY: </strong>"+e.ID[n].company.toUpperCase()+"<br><strong>SALARY: </strong>"+p+"</div>"
var m="images/standardMarker.svg",u=addMarker(e,t,n,c,m,l)
markers.push(u)
var d=!1
google.maps.event.addListener(u,"click",function(r){if(d)void 0==this.url||"null"==this.url?console.log("error"):window.open(this.url),d=!1
else{t=initMap(e,a),this.setMap(t)
var s=r.latLng.lat(),n=r.latLng.lng()
placeHomeMarker(t,s,n,a),d=!0}})}}catch(f){console.log(f.message)}}if("DUBLIN"==a.toUpperCase()){var v={imagePath:"images/m"}
markerCluster=new MarkerClusterer(t,markers,v)}}function placeHomeMarker(e,t,a,r){try{readTextFile("data/coordinates_myhome.json",function(s){var n=JSON.parse(s),o=0,i=5,l=0
l=autoDistance(o,i,n,e,r,l,t,a),3>l&&(o=5,i=10,l=autoDistance(o,i,n,e,r,l,t,a)),3>l&&(o=10,i=20,l=autoDistance(o,i,n,e,r,l,t,a)),3>l&&console.log("this county is doomed!")
var p={imagePath:"images/m"}
new MarkerClusterer(e,aMarkers,p)})}catch(s){console.log(s.message)}}function autoDistance(e,t,a,r,s,n,o,i){var l,p
aMarkers=[]
var g={lat:o,lng:i},c=Object.keys(a.ID).length
switch(t){case 5:l=5e3,cicleColor="#228b22"
break
case 10:l=1e4,p="#ffe200"
break
case 20:l=2e4,p="#ff0000"
break
default:l=5e3,cicleColor="#228b22"}for(var m="images/home.svg",u=0;c>u;u++){var d=a.ID[u].address
if(d.toUpperCase().includes(s.toUpperCase())){var f=calculateDistance(o,i,a.ID[u].lat,a.ID[u].lng),v=a.ID[u].price,y=(new google.maps.Circle({strokeColor:p,strokeOpacity:.2,strokeWeight:2,fillOpacity:0,map:r,center:g,radius:l}),1e3),h=2e3
if(v>y&&h>v&&f>e&&t>f){n+=1
var M="<div id='img' style='float:left'><img src='http://i.stack.imgur.com/g672i.png'></div><div style = 'float:right; padding: 10px; font-size:18px'><strong>COST: "+v+"â‚¬</strong><br><br><strong>ADDRESS: </stong>"+d+"</div>",k=a.ID[u].url,D=addMarker(a,r,u,M,m,k)
aMarkers.push(D),google.maps.event.addListener(D,"click",function(){window.open(this.url,"_blank")})}}}return n}function readTextFile(e,t){var a=new XMLHttpRequest
a.overrideMimeType("application/json"),a.open("GET",e,!0),a.onreadystatechange=function(){4===a.readyState&&"200"==a.status&&t(a.responseText)},a.send(null)}function getAllUrlParams(e){var t=e?e.split("?")[1]:window.location.search.slice(1),a={}
if(t){t=t.split("#")[0]
for(var r=t.split("&"),s=0;s<r.length;s++){var n=r[s].split("="),o=void 0,i=n[0].replace(/\[\d*\]/,function(e){return o=e.slice(1,-1),""}),l=void 0===n[1]?!0:n[1]
i=i.toLowerCase(),l=l.toLowerCase(),a[i]?("string"==typeof a[i]&&(a[i]=[a[i]]),void 0===o?a[i].push(l):a[i][o]=l):a[i]=l}}return a}var markers=[],aMarkers=[],markerCluster
