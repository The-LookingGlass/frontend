var data,proj=d3.geo.albers().origin([-9.5,48.1]).scale(1e4).translate([250,1260]),path=d3.geo.path().projection(proj),svg=d3.select("#chart").append("svg"),counties=svg.append("g").attr("id","ireland"),tooltip=d3.select("body").append("div").attr("class","tooltip").style("opacity",0),industry=getAllUrlParams().industry;function quantize(t){return data[t.properties.id]<10?"q2-9":data[t.properties.id]<30?"q4-9":data[t.properties.id]<60?"q6-9":data[t.properties.id]<75?"q7-9":75<data[t.properties.id]?"q8-9":void 0}function getAllUrlParams(t){var e=t?t.split("?")[1]:window.location.search.slice(1),a={};if(e)for(var o=(e=e.split("#")[0]).split("&"),i=0;i<o.length;i++){var r=o[i].split("="),n=void 0,s=r[0].replace(/\[\d*\]/,function(t){return n=t.slice(1,-1),""}),l=void 0===r[1]||r[1];s=s.toLowerCase(),l=l.toLowerCase(),a[s]?("string"==typeof a[s]&&(a[s]=[a[s]]),void 0===n?a[s].push(l):a[s][n]=l):a[s]=l}return a}d3.json("ireland.json",function(t){counties.selectAll("path").data(t.features).enter().append("path").attr("class","ireland").attr("d",path).on("mouseover",function(t){tooltip.transition().duration(200).style("opacity",1),tooltip.html(t.properties.id).style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("click",function(t){var e=getAllUrlParams().industry;window.history.replaceState(null,null,"map.html?industry="+e+"&county="+t.properties.id)}).on("mouseout",function(){tooltip.transition().duration(500).style("opacity",0)})}),d3.json("data/job_data_heatmap.json",function(t){data=t[industry],counties.selectAll("path").attr("class",quantize)});